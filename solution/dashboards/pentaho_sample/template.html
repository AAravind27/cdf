<SCRIPT LANGUAGE="JavaScript">

// This is a custom function that is fired when a user selects a productLine and then want to select a territory
// Its purpose is to reset the productLine variable back to null and pass the territory that has been selected
// The function is executed from the url-template tag in the territorySales.xaction

function clickOnRegion(value) {
	department = "null";
	Dashboards.fireChange('region',value);
}

</SCRIPT>

<!-- The page_title_object -->





<!-- The dashboard layout table -->
<table align="center" style="border: 0px solid #000;">
	<tr>
		<td align="center" colspan="2">
			<p><h3 style="font-family: Arial;" id="title"><span align="center" id=page_title_object></span></h3></p>
		</td>
	</tr>
	<tr>
	<td>
	<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;"
			border="0" cellpadding="2" cellspacing="2" >
		<tr>
			<td style="width: 50%; text-align: center; vertical-align: middle;" ><div id="RegionsPieChartObject"></div></td>
			<td style="width: 50%; text-align: center; vertical-align: middle;"><div id="RegionVarianceBarChartObject"></div></td>
		</tr>
		<tr>
			<td style="width: 50%; text-align: center; vertical-align: middle;"><div id="DepartmentDialChartObject"></div></td>
			<td style="width: 50%; text-align: center; vertical-align: middle;"><div id="EmbeddedReportObject"></div></td>
		</tr>
	</table>
	</td>
	</tr>
</table>


<script language="javascript" type="text/javascript">

// Define script variables before script execution
var region = "null";
var department = "null";
var title="title";

// pageTitleString component generates the page title with any other parameters is may need to construct the string
pageTitleString = 
{
  name: "pageTitleString",
  type: "text",
  listeners:["region", "department"],
  htmlObject: "page_title_object",
  executeAtStart: true,
  expression: function(){return "title"},
  preExecution:function(){
    if(region == "null" && department == "null") {
      title="Select a region";
    }
    else if (region != "null" && department == "null") {
      title="This is headcount spending for " + region;
    }
    else if (region != "null" && department != "null") {
      title = "This is headcount spending for " + region + ", " + department;
    }
  },
  postExecution:function(){}
}

// RegionsPieChart component generates the 
RegionsPieChart = 
{
  name: "RegionsPieChart",
  type: "xaction",
  solution: "dashboards",
  path: "pentaho_sample",
  action: "RegionsPieChart.xaction",
  listeners:[],
  parameters: [],
  htmlObject: "RegionsPieChartObject",
  executeAtStart: true
}

// RegionVarianceBarChart component generates the 
RegionVarianceBarChart = 
{
  name: "RegionVarianceBarChart",
  type: "xaction",
  solution: "dashboards",
  path: "pentaho_sample",
  action: "RegionVarianceBarChart.xaction",
  listeners:["region"],
  parameters: [["REGION","region"]],
  htmlObject: "RegionVarianceBarChartObject",
  executeAtStart: false,
  preExecution:function(){document.getElementById('DepartmentDialChartObject').innerHTML="";document.getElementById('EmbeddedReportObject').innerHTML="";}
}

// DepartmentDialChart component generates the 
DepartmentDialChart = 
{
  name: "DepartmentDialChart",
  type: "xaction",
  solution: "dashboards",
  path: "pentaho_sample",
  action: "DepartmentDialChart.xaction",
  listeners:["department"],
  parameters: [["DEPARTMENT","department"],["REGION","region"]],
  htmlObject: "DepartmentDialChartObject",
  executeAtStart: false
}

// EmbeddedReport component generates the 
EmbeddedReport = 
{
  name: "EmbeddedReport",
  type: "xaction",
  solution: "dashboards",
  path: "pentaho_sample",
  action: "embedded_report.xaction",
  listeners:["department"],
  parameters: [["DEPARTMENT","department"],["REGION","region"]],
  htmlObject: "EmbeddedReportObject",
  executeAtStart: false
}

// These are the components to be loaded into the dashboard withing the [] seperated by ,
var components = [pageTitleString, RegionsPieChart, RegionVarianceBarChart, DepartmentDialChart, EmbeddedReport];


</script>

<script language="javascript" type="text/javascript">

// The intial dashboard load function definition
function load(){
	Dashboards.init(components);
}

// The intial dashboard load function execution
load();

</script>
